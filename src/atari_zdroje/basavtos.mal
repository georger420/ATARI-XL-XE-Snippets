0900 ;   .OPT OBJ›1000     .TITLE "*** T2000 BASIC SAVER ***"›1010 ;›1020     .SET 1,6›1030     .SET 3,0›1040     .SET 4,72›1050 ;›1060 ;SYSTEMOVE PROMENNE:›1070 ;›1080 ICHID = $0340›1090 ICDNO = $0341›1100 ICCOM = $0342›1110 ICSTA = $0343›1120 ICBA =  $0344›1130 ICPT =  $0346›1140 ICBL =  $0348›1150 ICAX1 = $034A›1160 ICAX2 = $034B›1170 CIOV =  $E456›1180 LOMEM = $80›1190 STARP = $8C›1200 CHAROUT = $F2B0›1210 DOSVEC = $0A›1230 BELL =  $FDFC›1240 GETKEY = $F2F8›1250 POMZ1 = $D4›1260 POMZ2 = $D6›1270 HEAD =  $0400›1280 ZAC =   $32›1290 KON =   ZAC+2›1300 TSAVE = $161E›1310 PISMENA = 702›1990 ;›2000 ;POMOCNE  ADRESY   :›2010 ;›2020 BUF =   $0700›2990 ;›3000 ;TEXTY:›3010 ;›3015     *=  $9500›3016 ;›3020 ZAHLAVI .BYTE 125›3030     .BYTE +$80,"  TURBO 2000 BASIC SAVER FOR TOS 4.1  "›3040     .BYTE +$80,"         by J.S. AK-602 1992          "›3050     .BYTE $9B,$9B›3060     .BYTE "Lomem: $"›3070 ;›3080 DELKAT .BYTE "Lenght (Bytes): $"›3090 ;›3100 NEWLOM .BYTE "New Lomem: $"›3110 ;›3120 NAZEV .BYTE "Name (max 10 ch.): "›3130 ;›3140 SAVING .BYTE "Saving T 2000 file ..."›3150     .BYTE $9B,$9B›3160 ;›3170 ZNOVU .BYTE "Once again? ... Y/N"›3180     .BYTE $9B,$9B›3190 ;›3200 ABECEDA .BYTE "0123456789ABCDEF"›3210 ;›5000 STARUT .BYTE $A2,$0D,$BD,$F2›5010     .BYTE $07,$95,$80,$CA›5020     .BYTE $10,$F8,$A2,$FF›5030     .BYTE $9A,$A9,$A9,$48›5040     .BYTE $A9,$79,$48,$A9›5050     .BYTE $0A,$85,$C9,$A9›5060     .BYTE $00,$85,$09,$8D›5070     .BYTE $F8,$03,$A9,$FD›5080     .BYTE $8D,$01,$D3,$A9›5090     .BYTE $B7,$48,$A9,$54›5100     .BYTE $48,$A5,$6A,$10›5110     .BYTE $02,$A9,$A0,$85›5120     .BYTE $6A,$4C,$94,$EF›5130 ;›5500 ;POMOCNE PROMENNE:›5510 ;›5540 NOVALO .BYTE 0,0›5550 ROZDIL .BYTE 0,0›5560 DELKA .BYTE 0,0›5570 POM .BYTE 0,0›5990 ;›6000 ;POMOCNE PROCEDURY›6010 ;›6020 ;SUBR TISK›6030 ;X-LOADR, Y-HIADR, A-BYTES›6040 ;›6050 TISK PHA ›6060     TXA ›6070     PHA ›6080     LDX #0›6090     LDA #11›6100     STA ICCOM,X›6110     PLA ›6120     STA ICBA,X›6130     TYA ›6140     STA ICBA+1,X›6150     PLA ›6160     STA ICBL,X›6170     LDA #0›6180     STA ICBL+1,X›6190     JSR CIOV›6200     RTS ›6210 ;›6220 ;SUBR PULHA›6230 ;PREVADI 1 BAJT NA ASCII›6240 ;VSTUP...V A›6250 ;VYSTUP...HIASC-Y,LOASC-X›6260 ;›6270 PULHA PHA ›6280     AND #$F0›6290     LSR A›6300     LSR A›6310     LSR A›6320     LSR A›6330     TAY ›6340     LDA ABECEDA,Y›6350     TAY ›6360     PLA ›6370     AND #$0F›6380     TAX ›6390     LDA ABECEDA,X›6400     TAX ›6410     RTS ›6420 ;›6430 ;SUBR A2HEX›6440 ;ASCII BAJT NA HEX 0-15›6450 ;›6460 A2HEX SEC ›6470     SBC #'0›6480     CMP #10›6490     BCC A2HEX1›6500     SBC #7›6510 A2HEX1 RTS ›6520 ;›6530 ;SUBR PULAH›6540 ;2 ASCII ZNAKY NA HEXCISLO›6550 ;VSTUP: V A-HI V Y-LO›6560 ;VYSTUP: V A›6570 ;›6590 PULAH STY POM›6600     ASL A›6610     ASL A›6620     ASL A›6630     ASL A›6640     ORA POM›6650     RTS ›6660 ;›6670 ;SUBR BUFOUT›6680 ;VYTISKNE BUFFER›6690 ;V A-POCET ZNAKU›6700 ;›6710 BUFOUT LDX # <BUF›6720     LDY # >BUF›6730     JSR TISK›6740     RTS ›6750 ;›6760 ;SUBR BUFIN›6770 ;NACTE RETEZEC (NA KONCI RETURN)›6780 ;›6790 BUFIN LDX #0›6800     LDA #5›6810     STA ICCOM,X›6820     LDA # <BUF›6830     STA ICBA,X›6840     LDA # >BUF›6850     STA ICBA+1,X›6860     JSR CIOV›6870     RTS ›6880 ;›6890 ;SUBR NUMBUF›6900 ;PREVEDE 2 BAJTY HEX NA ASCII›6910 ;A UMISTI DO BUFFERU A ZA NE›6920 ;2-KRAT RETURN›6930 ;VOLANI: V X-LO, V Y-HI›6940 ;›6950 NUMBUF TXA ›6960     PHA ›6970     TYA ›6980     JSR PULHA›6990     STY BUF›7000     STX BUF+1›7010     PLA ›7020     JSR PULHA›7030     STY BUF+2›7040     STX BUF+3›7050     LDA #$9B›7060     STA BUF+4›7070     STA BUF+5›7080     RTS ›7090 ;›7100 ;SUBR LOMOUT›7110 ;VYTISKNE OBSAH LOMEM›7120 ;›7130 LOMOUT LDX LOMEM›7140     LDY LOMEM+1›7150     JSR NUMBUF›7160     LDA #6›7170     JSR BUFOUT›7180     RTS ›7190 ;›7200 ;SUBR NOVLOM1›7210 ;VYPISE "NEW LOMEM: $"›7220 ;›7230 NOVLOM1 LDX # <NEWLOM›7240     LDY # >NEWLOM›7250     LDA #NAZEV-NEWLOM›7260     JSR TISK›7270     RTS ›7280 ;›7290 ;SUBR VSUVKA›7300 ;VYPOCTE NOVOU ADRESU TABULKY›7310 ;BAS. UKAZATELU A ULOZI JI›7320 ;DO STARTOVACI RUTINY›7330 ;›7340 VSUVKA LDY #3›7350     LDA NOVALO›7355     CLC ›7360     ADC #$F2›7370     STA (LOMEM),Y›7380     PHP ›7390     INY ›7400     PLP ›7410     LDA NOVALO+1›7420     ADC #0›7430     STA (LOMEM),Y›7440     RTS ›7450 ;›010000 ;VLASTNI PROGRAM›010010 ;›010020 ; *=  $5800›010030 ;›010032 VLAST LDA #64›010033   STA PISMENA›010034 ;›010040 VYPZAH LDX # <ZAHLAVI›010050   LDY # >ZAHLAVI›010060   LDA #DELKAT-ZAHLAVI›010070   JSR TISK›010080 ;›010090 VYPLOM JSR LOMOUT›010100 ;›010240 ;›010250 VYPDEL LDA STARP›010260   SEC ›010270   SBC LOMEM›010280   STA DELKA›010300   LDA STARP+1›010310   SBC LOMEM+1›010320   STA DELKA+1›010341   LDX # <DELKAT›010342   LDY # >DELKAT›010343   LDA #NEWLOM-DELKAT›010344   JSR TISK›010346   LDA DELKA›010348   TAX ›010350   LDA DELKA+1›010352   TAY ›010354   JSR NUMBUF›010356   LDA #6›010360   JSR BUFOUT›010370 ;›010470 ;›010480 NOVLOM JSR NOVLOM1›010490 ;›010520 ;›010530 LOMIN JSR BUFIN›010540 ;›010610 ;›010620   LDA BUF›010630   CMP #$9B›010640   BNE LOMIN1›010650 ;›010660   LDA #'›010670   JSR CHAROUT›010680   JSR NOVLOM1›010690   JSR LOMOUT›010720   LDA LOMEM+1›010725   STA NOVALO+1›010760   LDA LOMEM›010765   STA NOVALO›010855   JMP NAMEIN›010860 ;›010870 LOMIN1 LDA #$9B›010875   JSR CHAROUT›010876   LDX #0›010880 LOMIN2 LDA BUF,X›010890   JSR A2HEX›010900   STA BUF,X›010905   INX ›010910   CPX #4›010920   BNE LOMIN2›010930 ;›010940 CHECK LDX #0›010950 CHECK1 LDA BUF,X›010960   CMP #0›010970   BMI CHYBA›010980   CMP #16›010990   BPL CHYBA›010995   INX ›011000   CPX #4›011010   BNE CHECK1›011020   BEQ AHEX›011030 ;›011040 CHYBA LDA #$FD›011050   JSR CHAROUT›011060   JMP NOVLOM›011070 ;›011080 AHEX LDA BUF›011090   LDY BUF+1›011100   JSR PULAH›011110   STA NOVALO+1›011120   LDA BUF+2›011130   LDY BUF+3›011140   JSR PULAH›011150   STA NOVALO›011160 ;›011170 NAMEIN LDX # <NAZEV›011180   LDY # >NAZEV›011190   LDA #SAVING-NAZEV›011200   JSR TISK›011210 ;›011220   JSR BUFIN›011300 ;›011310 NAVRAT LDA BUF›011320   CMP #$9B›011330   BNE RADKUJ›011340   JMP (DOSVEC)›011350 ;›011360 RADKUJ LDA #$9B›011370   JSR CHAROUT›011380 ;›013000 VYMAZ LDY #255›013010   LDA #0›013020 VYMAZ1 STA (LOMEM),Y›013030   DEY ›013040   BPL VYMAZ1›013050 ;›013060 PRENES LDY #0›013070 PRENES1 LDA STARUT,Y›013080   STA (LOMEM),Y›013090   INY ›013100   CPY #NOVALO-STARUT›013110   BNE PRENES1›013120 ;›013190 ;›013200 OFSET LDA NOVALO›013210   SEC ›013220   SBC LOMEM›013230   STA ROZDIL›013240   LDA NOVALO+1›013250   SBC LOMEM+1›013260   STA ROZDIL+1›013270 ;›013280 PREPOCTI LDA LOMEM›013290   CLC ›013300   ADC #$F2›013310   STA POMZ1›013320   LDA LOMEM+1›013330   ADC #0›013340   STA POMZ1+1›013342   LDA # <LOMEM›013344   STA POMZ2›013346   LDA # >LOMEM›013348   STA POMZ2+1›013350   JSR VSUVKA›013355   LDY #0›013360 PREPOCTI1 LDA (POMZ2),Y›013370   CLC ›013380   ADC ROZDIL›013390   STA (POMZ1),Y›013400   PHP ›013410   INY ›013420   PLP ›013430   LDA (POMZ2),Y›013440   ADC ROZDIL+1›013450   STA (POMZ1),Y›013460   INY ›013470   CPY #$0E›013480   BNE PREPOCTI1›013490 ;›014000 ULOZ LDA #ZNOVU-SAVING›014010   LDX # <SAVING›014020   LDY # >SAVING›014030   JSR TISK›014040 ;›014050 HLAVICKA LDX #11›014060   LDA #$20›014070 HLAV1 STA HEAD,X›014080   DEX ›014090   BPL HLAV1›014100 ;›014110   LDA #3›014120   STA HEAD›014130   LDA NOVALO›014140   STA HEAD+11›014145   STA HEAD+15›014150   LDA NOVALO+1›014160   STA HEAD+12›014170   STA HEAD+16›014180   LDA DELKA›014190   STA HEAD+13›014200   LDA DELKA+1›014210   STA HEAD+14›014220   LDX #0›014230 HLAV3 LDA BUF,X›014240   CMP #$9B›014250   BEQ HLAV4›014260   STA HEAD+1,X›014270   INX ›014280   CPX #10›014290   BNE HLAV3›014300   BEQ HLAV5›014310 HLAV4 LDA #$20›014320   STA HEAD+1,X›014330 ;›014340 HLAV5 LDA # <HEAD›014350   STA ZAC›014360   LDA # >HEAD›014370   STA ZAC+1›014380   LDA # <HEAD+17›014390   STA KON›014400   LDA # >HEAD+17›014410   STA KON+1›014420 ;›014430   LDA #2›014440   JSR BELL›014450 ;›014460   LDA #0›014470   JSR TSAVE›014480 ;›014490 BLOK LDA LOMEM›014500   STA ZAC›014510   LDA LOMEM+1›014520   STA ZAC+1›014530   LDA STARP›014540   STA KON›014550   LDA STARP+1›014560   STA KON+1›014570 ;›014580   LDA #255›014590   JSR TSAVE›014600 ;›014610   LDX # <ZNOVU›014620   LDY # >ZNOVU›014630   LDA #ABECEDA-ZNOVU›014640   JSR TISK›014650 ;›014660   JSR GETKEY›014670   CMP #'Y›014680   BEQ HLAV5›014690 ;›014700 DOS JMP (DOSVEC)›014710 ;›014720 UPLNYKONEC RTS ›015000   *=  $02E0›015010   .WORD VLAST›015020   .WORD VLAST›